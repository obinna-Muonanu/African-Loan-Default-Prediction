{"cells":[{"cell_type":"markdown","source":["The goal of this work is to develop a robust, generalisable machine learning model (xgboost) to predict the likelihood of loan defaults for both existing customers and new applicants."],"metadata":{"id":"lZjUBDjXmN96"}},{"cell_type":"code","source":["#pip install optuna"],"metadata":{"id":"nagOUL37mPWc"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":1,"metadata":{"id":"r7S1Bf0pkkU6","executionInfo":{"status":"ok","timestamp":1736945365561,"user_tz":-60,"elapsed":8339,"user":{"displayName":"Obinna Muonanu","userId":"17052340600237834499"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","#import optuna\n","import warnings\n","warnings.filterwarnings('ignore')\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.metrics import confusion_matrix, classification_report\n","from sklearn.model_selection import StratifiedGroupKFold, cross_val_score\n","from sklearn.metrics import f1_score, roc_auc_score, roc_curve, auc, accuracy_score,precision_score,recall_score\n","from sklearn.model_selection import train_test_split\n","import xgboost as xgb"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":92855,"status":"ok","timestamp":1736945468588,"user":{"displayName":"Obinna Muonanu","userId":"17052340600237834499"},"user_tz":-60},"id":"oubHIMyqdJbF","outputId":"35ce94ce-63ed-4d1d-fb5a-31faf6440601"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"51lf4fqVg7GC"},"source":["# Helper Functions"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2okTfFFsg4wU"},"outputs":[],"source":["def calculate_class_weights(y):\n","\n","    #Function to calculate class weights based on class distribution in the target variable.\n","\n","    unique_classes, class_counts = np.unique(y, return_counts=True)\n","    total_samples = len(y)\n","    class_weights = {}\n","\n","    for class_label, class_count in zip(unique_classes, class_counts):\n","        class_weight = total_samples / (2.0 * class_count)\n","        class_weights[class_label] = class_weight\n","\n","    return class_weights\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"juQoM9AIg5CF"},"outputs":[],"source":["def plot_confusion_matrix(y_true, y_pred, class_names, figsize=(8, 6)):\n","\n","    #Visualize the confusion matrix for model evaluation.\n","\n","    cm = confusion_matrix(y_true, y_pred)\n","    plt.figure(figsize=figsize)\n","    sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=class_names, yticklabels=class_names)\n","    plt.title(\"Confusion Matrix\")\n","    plt.xlabel(\"Predicted Label\")\n","    plt.ylabel(\"True Label\")\n","    plt.show()\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"65qJZmQMg5Wh"},"outputs":[],"source":["def stratified_groupkfold_cv(model, X, y, groups, n_splits=None, class_weights=None, verbose=False):\n","\n","    sgkf = StratifiedGroupKFold(n_splits=n_splits, shuffle=True, random_state=65)\n","    f1_scores = []\n","\n","    for fold, (train_index, test_index) in enumerate(sgkf.split(X, y, groups)):\n","        if verbose:\n","            print(f\"Fold {fold+1}/{n_splits}\")\n","\n","        # Split the data into training and testing sets\n","        X_train, X_test = X.iloc[train_index], X.iloc[test_index]\n","        y_train, y_test = y.iloc[train_index], y.iloc[test_index]\n","\n","        # Initialize the model with class weights if provided\n","        if class_weights:\n","            model.set_params(class_weight=class_weights)\n","\n","        model.fit(X_train, y_train)\n","\n","        # Make predictions and evaluate F1 score\n","        preds = model.predict(X_test)\n","        f1 = f1_score(y_test, preds)\n","        f1_scores.append(f1)\n","\n","        if verbose:\n","            print(f\"F1 Score: {f1:.4f}\")\n","\n","    mean_f1_score = np.mean(f1_scores)\n","    if verbose:\n","        print(f\"Mean F1 Score: {mean_f1_score:.4f}\")\n","\n","    return mean_f1_score\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DFEhVq0LofOc"},"outputs":[],"source":["def visualize_feature_importance(model, feature_names, top_n=25):\n","\n","    # Extract feature importances\n","    importance = model.feature_importances_\n","\n","    importance_df = pd.DataFrame({\n","        'Feature': feature_names,\n","        'Importance': importance\n","    }).sort_values(by='Importance', ascending=False)\n","\n","    top_features = importance_df.head(top_n)\n","\n","    plt.figure(figsize=(10, 6))\n","    plt.barh(top_features['Feature'], top_features['Importance'], color='skyblue')\n","    plt.xlabel('Importance')\n","    plt.ylabel('Feature')\n","    plt.title(f'Top {top_n} Feature Importances')\n","    plt.gca().invert_yaxis()  # Invert y-axis to show the most important at the top\n","    plt.show()\n"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"elapsed":2983,"status":"ok","timestamp":1736945482613,"user":{"displayName":"Obinna Muonanu","userId":"17052340600237834499"},"user_tz":-60},"id":"qAVL2LeNeg1i","outputId":"bb8b854d-c3be-478d-b081-167d72ffb27d"},"outputs":[{"output_type":"display_data","data":{"text/plain":["'Train_df'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["                      ID  customer_id country_id  tbl_loan_id  lender_id  \\\n","0  ID_266671248032267278       266671      Kenya       248032     267278   \n","1  ID_248919228515267278       248919      Kenya       228515     267278   \n","2  ID_308486370501251804       308486      Kenya       370501     251804   \n","3  ID_266004285009267278       266004      Kenya       285009     267278   \n","4  ID_253803305312267278       253803      Kenya       305312     267278   \n","\n","  loan_type  Total_Amount  Total_Amount_to_Repay disbursement_date  \\\n","0    Type_1        8448.0                 8448.0        2022-08-30   \n","1    Type_1       25895.0                25979.0        2022-07-30   \n","2    Type_7        6900.0                 7142.0        2024-09-06   \n","3    Type_1        8958.0                 9233.0        2022-10-20   \n","4    Type_1        4564.0                 4728.0        2022-11-28   \n","\n","     due_date  duration New_versus_Repeat  Amount_Funded_By_Lender  \\\n","0  2022-09-06         7       Repeat Loan                   120.85   \n","1  2022-08-06         7       Repeat Loan                  7768.50   \n","2  2024-09-13         7       Repeat Loan                  1380.00   \n","3  2022-10-27         7       Repeat Loan                  2687.40   \n","4  2022-12-05         7       Repeat Loan                  1369.20   \n","\n","   Lender_portion_Funded  Lender_portion_to_be_repaid  target  \n","0               0.014305                        121.0       0  \n","1               0.300000                       7794.0       0  \n","2               0.200000                       1428.0       0  \n","3               0.300000                       2770.0       0  \n","4               0.300000                       1418.0       0  "],"text/html":["\n","  <div id=\"df-d51655ae-8089-4887-9a31-0dad44b1a950\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>customer_id</th>\n","      <th>country_id</th>\n","      <th>tbl_loan_id</th>\n","      <th>lender_id</th>\n","      <th>loan_type</th>\n","      <th>Total_Amount</th>\n","      <th>Total_Amount_to_Repay</th>\n","      <th>disbursement_date</th>\n","      <th>due_date</th>\n","      <th>duration</th>\n","      <th>New_versus_Repeat</th>\n","      <th>Amount_Funded_By_Lender</th>\n","      <th>Lender_portion_Funded</th>\n","      <th>Lender_portion_to_be_repaid</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ID_266671248032267278</td>\n","      <td>266671</td>\n","      <td>Kenya</td>\n","      <td>248032</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>8448.0</td>\n","      <td>8448.0</td>\n","      <td>2022-08-30</td>\n","      <td>2022-09-06</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>120.85</td>\n","      <td>0.014305</td>\n","      <td>121.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ID_248919228515267278</td>\n","      <td>248919</td>\n","      <td>Kenya</td>\n","      <td>228515</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>25895.0</td>\n","      <td>25979.0</td>\n","      <td>2022-07-30</td>\n","      <td>2022-08-06</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>7768.50</td>\n","      <td>0.300000</td>\n","      <td>7794.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ID_308486370501251804</td>\n","      <td>308486</td>\n","      <td>Kenya</td>\n","      <td>370501</td>\n","      <td>251804</td>\n","      <td>Type_7</td>\n","      <td>6900.0</td>\n","      <td>7142.0</td>\n","      <td>2024-09-06</td>\n","      <td>2024-09-13</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>1380.00</td>\n","      <td>0.200000</td>\n","      <td>1428.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ID_266004285009267278</td>\n","      <td>266004</td>\n","      <td>Kenya</td>\n","      <td>285009</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>8958.0</td>\n","      <td>9233.0</td>\n","      <td>2022-10-20</td>\n","      <td>2022-10-27</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>2687.40</td>\n","      <td>0.300000</td>\n","      <td>2770.0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ID_253803305312267278</td>\n","      <td>253803</td>\n","      <td>Kenya</td>\n","      <td>305312</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>4564.0</td>\n","      <td>4728.0</td>\n","      <td>2022-11-28</td>\n","      <td>2022-12-05</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>1369.20</td>\n","      <td>0.300000</td>\n","      <td>1418.0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d51655ae-8089-4887-9a31-0dad44b1a950')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-d51655ae-8089-4887-9a31-0dad44b1a950 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-d51655ae-8089-4887-9a31-0dad44b1a950');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-0886b3c1-c34d-4e52-9674-a421145502d9\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0886b3c1-c34d-4e52-9674-a421145502d9')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0886b3c1-c34d-4e52-9674-a421145502d9 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"display('Train_df', data1\",\n  \"rows\": 5,\n  \"fields\": [\n    {\n      \"column\": \"ID\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"ID_248919228515267278\",\n          \"ID_253803305312267278\",\n          \"ID_308486370501251804\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"customer_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 23491,\n        \"min\": 248919,\n        \"max\": 308486,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          248919,\n          253803,\n          308486\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"country_id\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"Kenya\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"tbl_loan_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 55338,\n        \"min\": 228515,\n        \"max\": 370501,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          228515\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"lender_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 6920,\n        \"min\": 251804,\n        \"max\": 267278,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          251804\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"loan_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 2,\n        \"samples\": [\n          \"Type_7\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Amount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 8525.909687534815,\n        \"min\": 4564.0,\n        \"max\": 25895.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          25895.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Amount_to_Repay\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 8487.805988593283,\n        \"min\": 4728.0,\n        \"max\": 25979.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          25979.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"disbursement_date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"2022-07-30\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"due_date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"2022-08-06\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"duration\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 7,\n        \"max\": 7,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          7\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"New_versus_Repeat\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"Repeat Loan\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Amount_Funded_By_Lender\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2993.7115630935455,\n        \"min\": 120.85,\n        \"max\": 7768.5,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          7768.5\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Lender_portion_Funded\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.12436784077014106,\n        \"min\": 0.0143051609848484,\n        \"max\": 0.3,\n        \"num_unique_values\": 3,\n        \"samples\": [\n          0.0143051609848484\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Lender_portion_to_be_repaid\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 2994.423684116862,\n        \"min\": 121.0,\n        \"max\": 7794.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          7794.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"target\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 0,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["'Test_df'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["                      ID  customer_id country_id  tbl_loan_id  lender_id  \\\n","0  ID_269404226088267278       269404      Kenya       226088     267278   \n","1  ID_255356300042267278       255356      Kenya       300042     267278   \n","2  ID_257026243764267278       257026      Kenya       243764     267278   \n","3  ID_264617299409267278       264617      Kenya       299409     267278   \n","4  ID_247613296713267278       247613      Kenya       296713     267278   \n","\n","  loan_type  Total_Amount  Total_Amount_to_Repay disbursement_date  \\\n","0    Type_1        1919.0                 1989.0        2022-07-27   \n","1    Type_1        2138.0                 2153.0        2022-11-16   \n","2    Type_1        8254.0                 8304.0        2022-08-24   \n","3    Type_1        3379.0                 3379.0        2022-11-15   \n","4    Type_1         120.0                  120.0        2022-11-10   \n","\n","     due_date  duration New_versus_Repeat  Amount_Funded_By_Lender  \\\n","0  2022-08-03         7       Repeat Loan                    575.7   \n","1  2022-11-23         7       Repeat Loan                      0.0   \n","2  2022-08-31         7       Repeat Loan                    207.0   \n","3  2022-11-22         7       Repeat Loan                   1013.7   \n","4  2022-11-17         7       Repeat Loan                     36.0   \n","\n","   Lender_portion_Funded  Lender_portion_to_be_repaid  \n","0               0.300000                        597.0  \n","1               0.000000                          0.0  \n","2               0.025079                        208.0  \n","3               0.300000                       1014.0  \n","4               0.300000                         36.0  "],"text/html":["\n","  <div id=\"df-fdf00b09-0739-4301-8fe7-f48cca25fa18\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ID</th>\n","      <th>customer_id</th>\n","      <th>country_id</th>\n","      <th>tbl_loan_id</th>\n","      <th>lender_id</th>\n","      <th>loan_type</th>\n","      <th>Total_Amount</th>\n","      <th>Total_Amount_to_Repay</th>\n","      <th>disbursement_date</th>\n","      <th>due_date</th>\n","      <th>duration</th>\n","      <th>New_versus_Repeat</th>\n","      <th>Amount_Funded_By_Lender</th>\n","      <th>Lender_portion_Funded</th>\n","      <th>Lender_portion_to_be_repaid</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>ID_269404226088267278</td>\n","      <td>269404</td>\n","      <td>Kenya</td>\n","      <td>226088</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>1919.0</td>\n","      <td>1989.0</td>\n","      <td>2022-07-27</td>\n","      <td>2022-08-03</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>575.7</td>\n","      <td>0.300000</td>\n","      <td>597.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>ID_255356300042267278</td>\n","      <td>255356</td>\n","      <td>Kenya</td>\n","      <td>300042</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>2138.0</td>\n","      <td>2153.0</td>\n","      <td>2022-11-16</td>\n","      <td>2022-11-23</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>0.0</td>\n","      <td>0.000000</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>ID_257026243764267278</td>\n","      <td>257026</td>\n","      <td>Kenya</td>\n","      <td>243764</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>8254.0</td>\n","      <td>8304.0</td>\n","      <td>2022-08-24</td>\n","      <td>2022-08-31</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>207.0</td>\n","      <td>0.025079</td>\n","      <td>208.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>ID_264617299409267278</td>\n","      <td>264617</td>\n","      <td>Kenya</td>\n","      <td>299409</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>3379.0</td>\n","      <td>3379.0</td>\n","      <td>2022-11-15</td>\n","      <td>2022-11-22</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>1013.7</td>\n","      <td>0.300000</td>\n","      <td>1014.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>ID_247613296713267278</td>\n","      <td>247613</td>\n","      <td>Kenya</td>\n","      <td>296713</td>\n","      <td>267278</td>\n","      <td>Type_1</td>\n","      <td>120.0</td>\n","      <td>120.0</td>\n","      <td>2022-11-10</td>\n","      <td>2022-11-17</td>\n","      <td>7</td>\n","      <td>Repeat Loan</td>\n","      <td>36.0</td>\n","      <td>0.300000</td>\n","      <td>36.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-fdf00b09-0739-4301-8fe7-f48cca25fa18')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-fdf00b09-0739-4301-8fe7-f48cca25fa18 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-fdf00b09-0739-4301-8fe7-f48cca25fa18');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-75c7049d-9704-40d9-9d64-6cf5025a7d63\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-75c7049d-9704-40d9-9d64-6cf5025a7d63')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-75c7049d-9704-40d9-9d64-6cf5025a7d63 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","summary":"{\n  \"name\": \"display('Train_df', data1\",\n  \"rows\": 5,\n  \"fields\": [\n    {\n      \"column\": \"ID\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"ID_255356300042267278\",\n          \"ID_247613296713267278\",\n          \"ID_257026243764267278\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"customer_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 8462,\n        \"min\": 247613,\n        \"max\": 269404,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          255356,\n          247613,\n          257026\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"country_id\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"Kenya\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"tbl_loan_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 35518,\n        \"min\": 226088,\n        \"max\": 300042,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          300042\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"lender_id\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 267278,\n        \"max\": 267278,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          267278\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"loan_type\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"Type_1\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Amount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3075.017967427182,\n        \"min\": 120.0,\n        \"max\": 8254.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          2138.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Total_Amount_to_Repay\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3087.53064762117,\n        \"min\": 120.0,\n        \"max\": 8304.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          2153.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"disbursement_date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"2022-11-16\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"due_date\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"num_unique_values\": 5,\n        \"samples\": [\n          \"2022-11-23\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"duration\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 7,\n        \"max\": 7,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          7\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"New_versus_Repeat\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          \"Repeat Loan\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Amount_Funded_By_Lender\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 427.6754692520954,\n        \"min\": 0.0,\n        \"max\": 1013.7,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          0.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Lender_portion_Funded\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0.15769813335779737,\n        \"min\": 0.0,\n        \"max\": 0.3,\n        \"num_unique_values\": 3,\n        \"samples\": [\n          0.3\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Lender_portion_to_be_repaid\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 430.3951672591132,\n        \"min\": 0.0,\n        \"max\": 1014.0,\n        \"num_unique_values\": 5,\n        \"samples\": [\n          0.0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["'economic_indicator_df'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["         Country                                          Indicator  \\\n","0          Ghana              Inflation, consumer prices (annual %)   \n","1  Cote d'Ivoire              Inflation, consumer prices (annual %)   \n","2          Kenya              Inflation, consumer prices (annual %)   \n","3          Ghana  Official exchange rate (LCU per US$, period av...   \n","4  Cote d'Ivoire  Official exchange rate (LCU per US$, period av...   \n","\n","       YR2001      YR2002      YR2003      YR2004      YR2005      YR2006  \\\n","0   41.509496    9.360932   29.772980   18.042739   15.438992   11.679184   \n","1    4.361529    3.077265    3.296807    1.457988    3.885830    2.467191   \n","2    5.738598    1.961308    9.815691   11.624036   10.312778   14.453734   \n","3    0.716305    0.792417    0.866764    0.899495    0.905209    0.915107   \n","4  732.397693  693.713226  579.897426  527.338032  527.258363  522.425625   \n","\n","       YR2007      YR2008  ...      YR2014      YR2015      YR2016  \\\n","0   10.734267   16.494640  ...   15.489616   17.149970   17.454635   \n","1    1.892006    6.308528  ...    0.448682    1.251500    0.723178   \n","2    9.758880   26.239817  ...    6.878155    6.582154    6.297250   \n","3    0.932619    1.052275  ...    2.896575    3.714642    3.909817   \n","4  478.633718  446.000041  ...  493.757330  591.211698  592.605615   \n","\n","       YR2017      YR2018      YR2019      YR2020      YR2021      YR2022  \\\n","0   12.371922    7.808765    7.143640    9.887290    9.971089   31.255895   \n","1    0.685881    0.359409   -1.106863    2.425007    4.091952    5.276167   \n","2    8.005650    4.689806    5.239638    5.405162    6.107936    7.659863   \n","3    4.350533    4.585325    5.217367    5.595708    5.805700    8.272400   \n","4  580.656750  555.446458  585.911013  575.586005  554.530675  623.759701   \n","\n","       YR2023  \n","0   38.106966  \n","1    4.387117  \n","2    7.671396  \n","3   11.020408  \n","4  606.569750  \n","\n","[5 rows x 25 columns]"],"text/html":["\n","  <div id=\"df-3fcaf2b9-d997-4715-a21a-a1b7e0540933\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Country</th>\n","      <th>Indicator</th>\n","      <th>YR2001</th>\n","      <th>YR2002</th>\n","      <th>YR2003</th>\n","      <th>YR2004</th>\n","      <th>YR2005</th>\n","      <th>YR2006</th>\n","      <th>YR2007</th>\n","      <th>YR2008</th>\n","      <th>...</th>\n","      <th>YR2014</th>\n","      <th>YR2015</th>\n","      <th>YR2016</th>\n","      <th>YR2017</th>\n","      <th>YR2018</th>\n","      <th>YR2019</th>\n","      <th>YR2020</th>\n","      <th>YR2021</th>\n","      <th>YR2022</th>\n","      <th>YR2023</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Ghana</td>\n","      <td>Inflation, consumer prices (annual %)</td>\n","      <td>41.509496</td>\n","      <td>9.360932</td>\n","      <td>29.772980</td>\n","      <td>18.042739</td>\n","      <td>15.438992</td>\n","      <td>11.679184</td>\n","      <td>10.734267</td>\n","      <td>16.494640</td>\n","      <td>...</td>\n","      <td>15.489616</td>\n","      <td>17.149970</td>\n","      <td>17.454635</td>\n","      <td>12.371922</td>\n","      <td>7.808765</td>\n","      <td>7.143640</td>\n","      <td>9.887290</td>\n","      <td>9.971089</td>\n","      <td>31.255895</td>\n","      <td>38.106966</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Cote d'Ivoire</td>\n","      <td>Inflation, consumer prices (annual %)</td>\n","      <td>4.361529</td>\n","      <td>3.077265</td>\n","      <td>3.296807</td>\n","      <td>1.457988</td>\n","      <td>3.885830</td>\n","      <td>2.467191</td>\n","      <td>1.892006</td>\n","      <td>6.308528</td>\n","      <td>...</td>\n","      <td>0.448682</td>\n","      <td>1.251500</td>\n","      <td>0.723178</td>\n","      <td>0.685881</td>\n","      <td>0.359409</td>\n","      <td>-1.106863</td>\n","      <td>2.425007</td>\n","      <td>4.091952</td>\n","      <td>5.276167</td>\n","      <td>4.387117</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Kenya</td>\n","      <td>Inflation, consumer prices (annual %)</td>\n","      <td>5.738598</td>\n","      <td>1.961308</td>\n","      <td>9.815691</td>\n","      <td>11.624036</td>\n","      <td>10.312778</td>\n","      <td>14.453734</td>\n","      <td>9.758880</td>\n","      <td>26.239817</td>\n","      <td>...</td>\n","      <td>6.878155</td>\n","      <td>6.582154</td>\n","      <td>6.297250</td>\n","      <td>8.005650</td>\n","      <td>4.689806</td>\n","      <td>5.239638</td>\n","      <td>5.405162</td>\n","      <td>6.107936</td>\n","      <td>7.659863</td>\n","      <td>7.671396</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Ghana</td>\n","      <td>Official exchange rate (LCU per US$, period av...</td>\n","      <td>0.716305</td>\n","      <td>0.792417</td>\n","      <td>0.866764</td>\n","      <td>0.899495</td>\n","      <td>0.905209</td>\n","      <td>0.915107</td>\n","      <td>0.932619</td>\n","      <td>1.052275</td>\n","      <td>...</td>\n","      <td>2.896575</td>\n","      <td>3.714642</td>\n","      <td>3.909817</td>\n","      <td>4.350533</td>\n","      <td>4.585325</td>\n","      <td>5.217367</td>\n","      <td>5.595708</td>\n","      <td>5.805700</td>\n","      <td>8.272400</td>\n","      <td>11.020408</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Cote d'Ivoire</td>\n","      <td>Official exchange rate (LCU per US$, period av...</td>\n","      <td>732.397693</td>\n","      <td>693.713226</td>\n","      <td>579.897426</td>\n","      <td>527.338032</td>\n","      <td>527.258363</td>\n","      <td>522.425625</td>\n","      <td>478.633718</td>\n","      <td>446.000041</td>\n","      <td>...</td>\n","      <td>493.757330</td>\n","      <td>591.211698</td>\n","      <td>592.605615</td>\n","      <td>580.656750</td>\n","      <td>555.446458</td>\n","      <td>585.911013</td>\n","      <td>575.586005</td>\n","      <td>554.530675</td>\n","      <td>623.759701</td>\n","      <td>606.569750</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows Ã— 25 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3fcaf2b9-d997-4715-a21a-a1b7e0540933')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-3fcaf2b9-d997-4715-a21a-a1b7e0540933 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-3fcaf2b9-d997-4715-a21a-a1b7e0540933');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-09aa0764-9a7e-4b44-b0f4-ec615403319a\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-09aa0764-9a7e-4b44-b0f4-ec615403319a')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-09aa0764-9a7e-4b44-b0f4-ec615403319a button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe"}},"metadata":{}}],"source":["data1 = pd.read_csv(\"/content/drive/MyDrive/African Credit score Challenge/Train.csv\", low_memory=False)\n","data2 = pd.read_csv(\"/content/drive/MyDrive/African Credit score Challenge/Test.csv\", low_memory=False)\n","data3 = pd.read_csv(\"/content/drive/MyDrive/African Credit score Challenge/SampleSubmission.csv\")\n","data4 = pd.read_csv(\"/content/drive/MyDrive/African Credit score Challenge/economic_indicators.csv\")\n","\n","display('Train_df', data1.head(), \"Test_df\", data2.head(), \"economic_indicator_df\", data4.head())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zPLcusRY6s94"},"outputs":[],"source":["#create a copy of the datasets\n","df1 = data1.copy()\n","df2 = data2.copy()\n","df3 = data3.copy()\n","df4 = data4.copy()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZxH4tV2ZjBPl"},"outputs":[],"source":["#Descriptive summary of training data\n","\n","df1.describe().T"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pjDh0p6YM5M-"},"outputs":[],"source":["#Loaning an amount of 2 is unrealistic, Let's set the minimum loan amount to 1000\n","\n","df1 = df1[df1['Total_Amount'] >= 1000]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bSWLUdzVOoND"},"outputs":[],"source":["df1 = df1[df1['Total_Amount_to_Repay'] >= 1000]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8dYOtQpNpeio"},"outputs":[],"source":["#convert disbursement data and due date to datetime dtype\n","\n","df1['disbursement_date'] = pd.to_datetime(df1['disbursement_date'])\n","df1['due_date'] = pd.to_datetime(df1['due_date'])\n","\n","df2['disbursement_date'] = pd.to_datetime(df2['disbursement_date'])\n","df2['due_date'] = pd.to_datetime(df2['due_date'])"]},{"cell_type":"markdown","metadata":{"id":"6Rh4UrtBjvl9"},"source":["# Exploratory Data Analysis"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PkF2HeyXG7r8"},"outputs":[],"source":["#check if there are common entries between train and test set\n","train_set = set(zip(df1['customer_id'], df1['tbl_loan_id'], df1['lender_id']))\n","test_set = set(zip(df2['customer_id'], df2['tbl_loan_id'], df2['lender_id']))\n","\n","# Find the intersection (common entries) between the train and test datasets\n","common_entries = train_set.intersection(test_set)\n","\n","if common_entries:\n","    print(f\"Found {len(common_entries)} common entries between train and test datasets:\")\n","    for entry in common_entries:\n","        print(entry)\n","else:\n","    print(\"No common entries found between train and test datasets.\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JSG0gHSGkGMJ"},"outputs":[],"source":["# countplot to visualize target class distribution\n","plt.figure(figsize=(7,5))\n","sns.countplot(y='target', data= df1, palette={'0': 'lightgreen', '1': 'darkred'})\n","plt.title('Target Distribution')\n","plt.show()"]},{"cell_type":"markdown","metadata":{"id":"91TQWSvddUtW"},"source":["#### **There is a high class imbalance in the target feature.**\n","\n","Over the years, the majority of Zecron customers have consistently honored their loan obligations, with only a small proportion defaulting.\n","\n","**P.S:** *Zecron here is just a fictional name of the financial institution*"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mJDQzfcbo5EM"},"outputs":[],"source":["#Group the features into Categorical and Numerical features\n","\n","categorical_features = ['loan_type', 'New_versus_Repeat', 'lender_id']\n","Numerical_features = ['Total_Amount', 'Total_Amount_to_Repay','Amount_Funded_By_Lender', 'Lender_portion_Funded',\n","       'Lender_portion_to_be_repaid']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DCKyoNc9r2YF"},"outputs":[],"source":["# countplot to visualize the distribution of old and first time customers\n","\n","fig, axes = plt.subplots(1, 1, figsize=(6, 6))\n","\n","column = 'New_versus_Repeat'\n","title = 'New versus Repeat count'\n","\n","sns.countplot(x=column, data=df1, ax=axes, palette={'Repeat Loan': 'lightblue', 'New Loan': 'blue'})\n","axes.set_title(title)\n","axes.set_xlabel(column)\n","axes.set_ylabel('Count')\n","\n","# Add percentage values on top of each bar\n","total = len(df1[column])\n","for p in axes.patches:\n","    height = p.get_height()\n","    percentage = f'{100 * height / total:.1f}%'\n","    axes.annotate(percentage, (p.get_x() + p.get_width() / 2, height),\n","                  ha='center', va='bottom', fontsize=9, color='black', fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"markdown","source":["99.2% of Zecron customers are repeat borrowers, demonstrating strong trust in their services and consistent engagement with their offerings. In contrast, only 0.8% are first-time borrowers, highlighting a smaller segment of new customers."],"metadata":{"id":"FbKUyv33oeyV"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"stWXedWpeqB3"},"outputs":[],"source":["#count plot to visualize the fraction of customers who defaulted their loans in both Repeated Loan and New Loan category\n","\n","fig, axes = plt.subplots(1, 1, figsize=(8, 6))\n","\n","column = 'New_versus_Repeat'\n","title = 'New versus Repeat count'\n","\n","sns.countplot(x=column, hue='target', data=df1, ax=axes)\n","axes.set_title(title)\n","axes.set_xlabel(column)\n","axes.set_ylabel('Count')\n","\n","\n","plt.tight_layout()\n","plt.show()"]},{"cell_type":"markdown","source":["Across both Repeat Loan customers and New Loan customers, only a small fraction default on their loans."],"metadata":{"id":"LjMfCjr_s8TO"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"7hiOe1dvr99Y"},"outputs":[],"source":["#Let's see how many customers who took different loan types defaulted on their loans\n","\n","value_num = df1[df1['target']==1].groupby('loan_type')['target'].count()\n","value_num"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hOcE_WbDkqR5"},"outputs":[],"source":["#Lets see the number of customers that took each loan type\n","\n","# Calculate the count for each loan type\n","loan_type_counts = df1['loan_type'].value_counts()\n","\n","# Convert to a DataFrame for sorting\n","loan_type_counts = loan_type_counts.sort_values(ascending=False)\n","\n","# Create the color palette\n","colors = ['#4B0082'] + ['#D8BFD8'] * (len(loan_type_counts) - 1)\n","# Dark purple for the first bar, lighter purple for the rest\n","\n","# Create the plot\n","fig, axes = plt.subplots(1, 1, figsize=(15, 6))\n","\n","sns.barplot(x=loan_type_counts.index, y=loan_type_counts.values, ax=axes, palette=colors)\n","axes.set_title('Loan Type Count (Descending Order)')\n","axes.set_xlabel('Loan Type')\n","axes.set_ylabel('Count')\n","\n","# Add annotations for the count above each bar\n","for i, val in enumerate(loan_type_counts.values):\n","    axes.text(i, val + 0.01 * val, f'{val}', ha='center', fontsize=10, fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"markdown","source":[" This plot reveals that Type 1 loans are significantly more popular among our customers compared to other loan types.\n","\n"," This indicates a higher demand or alignment of Type 1 loans with customer needs."],"metadata":{"id":"xWCoQD7tvAar"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z-ttxzJ1qit8"},"outputs":[],"source":["#Lets visualize the percentage of customers that defaulted on each loan type\n","\n","# Calculate default rate for each loan type\n","loan_type_default_rate = df1.groupby('loan_type')['target'].mean()\n","\n","# Sort by default rate for better visualization\n","loan_type_default_rate = loan_type_default_rate.sort_values(ascending=False)\n","\n","# Create a colormap where the color fades as the bar height gets smaller\n","norm = plt.Normalize(loan_type_default_rate.min(), loan_type_default_rate.max())\n","cmap = plt.cm.Reds\n","\n","# Plot Default Rate by Loan Type\n","plt.figure(figsize=(12, 6))\n","bars = plt.bar(loan_type_default_rate.index, loan_type_default_rate.values, color=cmap(norm(loan_type_default_rate.values)))\n","#loan_type_default_rate.plot(kind='bar', color='skyblue')\n","plt.title('Default Rate by Loan Type')\n","plt.xlabel('Loan Type')\n","plt.ylabel('Default Rate')\n","plt.xticks(rotation=45, ha='right')\n","plt.grid(axis='y', linestyle='--', alpha=0.7)\n","\n","# Add percentage annotations\n","for p in bars:\n","    height = p.get_height()\n","    percentage = f'{100 * height:.1f}%'\n","    plt.gca().annotate(percentage, (p.get_x() + p.get_width() / 2, height),\n","                       ha='center', va='bottom', fontsize=9, color='black', fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sn5AvSOLncZj"},"outputs":[],"source":["#Lets visualize the number of customers that defaulted on each loan type\n","\n","# Calculate total defaults for each loan type\n","loan_type_default_count = df1[df1['target'] == 1].groupby('loan_type')['target'].count()\n","\n","# Sort by default count for better visualization\n","loan_type_default_count = loan_type_default_count.sort_values(ascending=False)\n","\n","colors = ['#8B0000'] + ['#FFCCCC'] * (len(loan_type_default_count) - 1)\n","\n","# Plot Default Count by Loan Type\n","# Create the plot\n","fig, axes = plt.subplots(1, 1, figsize=(15, 6))\n","sns.barplot(x=loan_type_default_count.index, y=loan_type_default_count.values, ax=axes, palette=colors)\n","#loan_type_default_count.plot(kind='bar', color='skyblue')\n","plt.title('Default Count by Loan Type')\n","plt.xlabel('Loan Type')\n","plt.ylabel('Default Count')\n","plt.xticks(rotation=45, ha='right')\n","plt.grid(axis='y', linestyle='--', alpha=0.7)\n","\n","# Add annotations for the default count above each bar\n","for i, val in enumerate(loan_type_default_count):\n","    plt.text(i, val + 1, f'{val}', ha='center', fontsize=10, fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"markdown","source":["Loan types A to E have a higher incidence of customer defaults compared to other loan types. However, it is important to note that these loan types are being utilized by only a small number of customers. This means that, while the default rate is relatively high for these loans, the overall impact on the portfolio may be less significant due to the smaller customer base."],"metadata":{"id":"-oiplUh02D4r"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"GV7s6asc0jrc"},"outputs":[],"source":["# Filter data for defaults (target = 1)\n","defaulted = df1[df1['target'] == 1]"]},{"cell_type":"code","source":["non_defaulted = df1[df1['target']==0]"],"metadata":{"id":"tBLiqbsz750X"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bU3qDVLh2ysX"},"outputs":[],"source":["#Visualize feature distributions\n","\n","fig, axes = plt.subplots(2,3, figsize=(15,10))\n","\n","sns.histplot(df1['Total_Amount'], kde=True, ax=axes[0,0])\n","axes[0,0].set_xlabel('Total Amount')\n","axes[0,0].set_ylabel('Count')\n","axes[0,0].set_title('Distribution of Total Amount')\n","\n","sns.histplot(df1['Total_Amount_to_Repay'], kde=True, ax=axes[0,1])\n","axes[0,1].set_xlabel('Total Amount to Repay')\n","axes[0,1].set_ylabel('Count')\n","axes[0,1].set_title('Distribution of Total Amount to Repay')\n","\n","sns.histplot(df1['Amount_Funded_By_Lender'], kde=True, ax=axes[0,2])\n","axes[0,2].set_xlabel('Amount Funded By Lender')\n","axes[0,2].set_ylabel('Count')\n","axes[0,2].set_title('Distribution of Amount Funded By Lender')\n","\n","sns.histplot(df1['Lender_portion_Funded'], kde=True, ax=axes[1,0])\n","axes[1,0].set_xlabel('Lender Portion Funded')\n","axes[1,0].set_ylabel('Count')\n","axes[1,0].set_title('Distribution of Lender Portion Funded')\n","\n","sns.histplot(df1['Lender_portion_to_be_repaid'], kde=True, ax=axes[1,1])\n","axes[1,1].set_xlabel('Lender Portion to be Repaid')\n","axes[1,1].set_ylabel('Count')\n","axes[1,1].set_title('Distribution of Lender Portion to be Repaid')\n","\n","axes[1,2].axis('off')\n","plt.tight_layout()\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gIB7MxZ_1BvJ"},"outputs":[],"source":["#Visualize the relationships between Numerical features based on target\n","\n","fig, axes = plt.subplots(5,2, figsize=(20,18))\n","\n","sns.regplot(x='Total_Amount', y='Total_Amount_to_Repay', data=df1[df1['target']==0], ax=axes[0,0], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount', y='Total_Amount_to_Repay', data=df1[df1['target']==1], ax=axes[0,0], color='red', label='Defaulters')\n","axes[0,0].set_xlabel('Total Amount')\n","axes[0,0].set_ylabel('Total_Amount_to_Repay')\n","axes[0,0].set_title('Relationship between Total Amount and Total_Amount_to_Repay')\n","\n","sns.regplot(x='Total_Amount', y='Amount_Funded_By_Lender', data=df1[df1['target']==0], ax=axes[0,1], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount', y='Amount_Funded_By_Lender', data=df1[df1['target']==1], ax=axes[0,1], color='red', label='Defaulters')\n","axes[0,1].set_xlabel('Total Amount')\n","axes[0,1].set_ylabel('Amount_Funded_By_Lender')\n","axes[0,1].set_title('Relationship between Total Amount and Amount_Funded_By_Lender')\n","\n","sns.regplot(x='Total_Amount', y='Lender_portion_Funded', data=df1[df1['target']==0], ax=axes[1,0], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount', y='Lender_portion_Funded', data=df1[df1['target']==1], ax=axes[1,0], color='red', label='Defaulters')\n","axes[1,0].set_xlabel('Total Amount')\n","axes[1,0].set_ylabel('Lender_portion_Funded')\n","axes[1,0].set_title('Relationship between Total Amount and Lender_portion_Funded')\n","\n","sns.regplot(x='Total_Amount', y='Lender_portion_to_be_repaid', data=df1[df1['target']==0], ax=axes[1,1], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount', y='Lender_portion_to_be_repaid', data=df1[df1['target']==1], ax=axes[1,1], color='red', label='Defaulters')\n","axes[1,1].set_xlabel('Total Amount')\n","axes[1,1].set_ylabel('Lender_portion_to_be_repaid')\n","axes[1,1].set_title('Relationship between Total Amount and Lender_portion_to_be_repaid')\n","\n","sns.regplot(x='Total_Amount_to_Repay', y='Amount_Funded_By_Lender', data=df1[df1['target']==0], ax=axes[2,0], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount_to_Repay', y='Amount_Funded_By_Lender', data=df1[df1['target']==1], ax=axes[2,0], color='red', label='Defaulters')\n","axes[2,0].set_xlabel('Total_Amount_to_Repay')\n","axes[2,0].set_ylabel('Amount_Funded_By_Lender')\n","axes[2,0].set_title('Relationship between Total Amount to Repay and Amount Funded By Lender')\n","\n","sns.regplot(x='Total_Amount_to_Repay', y='Lender_portion_Funded', data=df1[df1['target']==0], ax=axes[2,1], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount_to_Repay', y='Lender_portion_Funded', data=df1[df1['target']==1], ax=axes[2,1], color='red', label='Defaulters')\n","axes[2,1].set_xlabel('Total_Amount_to_Repay')\n","axes[2,1].set_ylabel('Lender_portion_Funded')\n","axes[2,1].set_title('Relationship between Total Amount to Repay and Lender_portion_Funded')\n","\n","sns.regplot(x='Total_Amount_to_Repay', y='Lender_portion_to_be_repaid', data=df1[df1['target']==0], ax=axes[3,0], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Total_Amount_to_Repay', y='Lender_portion_to_be_repaid', data=df1[df1['target']==1], ax=axes[3,0], color='red', label='Defaulters')\n","axes[3,0].set_xlabel('Total_Amount_to_Repay')\n","axes[3,0].set_ylabel('Lender_portion_to_be_repaid')\n","axes[3,0].set_title('Relationship between Total Amount to Repay and Lender_portion_to_be_repaid')\n","\n","sns.regplot(x='Amount_Funded_By_Lender', y='Lender_portion_Funded', data=df1[df1['target']==0], ax=axes[3,1], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Amount_Funded_By_Lender', y='Lender_portion_Funded', data=df1[df1['target']==1], ax=axes[3,1], color='red', label='Defaulters')\n","axes[3,1].set_xlabel('Amount_Funded_By_Lender')\n","axes[3,1].set_ylabel('Lender_portion_Funded')\n","axes[3,1].set_title('Relationship between Amount Funded By Lender and Lender_portion_Funded')\n","\n","sns.regplot(x='Amount_Funded_By_Lender', y='Lender_portion_to_be_repaid', data=df1[df1['target']==0], ax=axes[4,0], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Amount_Funded_By_Lender', y='Lender_portion_to_be_repaid', data=df1[df1['target']==1], ax=axes[4,0], color='red', label='Defaulters')\n","axes[4,0].set_xlabel('Amount_Funded_By_Lender')\n","axes[4,0].set_ylabel('Lender_portion_to_be_repaid')\n","axes[4,0].set_title('Relationship between Amount Funded By Lender and Lender_portion_to_be_repaid')\n","\n","sns.regplot(x='Lender_portion_Funded', y='Lender_portion_to_be_repaid', data=df1[df1['target']==0], ax=axes[4,1], color='blue', label='Non-Defaulters')\n","sns.regplot(x='Lender_portion_Funded', y='Lender_portion_to_be_repaid', data=df1[df1['target']==1], ax=axes[4,1], color='red', label='Defaulters')\n","axes[4,1].set_xlabel('Lender_portion_Funded')\n","axes[4,1].set_ylabel('Lender_portion_to_be_repaid')\n","axes[4,1].set_title('Relationship between Lender_portion_Funded and Lender_portion_to_be_repaid')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"markdown","source":["Some features, like the Total Amount Loaned and the Total Amount to be Repaid, Amount funded by lender and Lender portion to be repaid are highly correlated i.e practically mirroring each other. This could be a problem because when two features are this closely related, they risk confusing the model."],"metadata":{"id":"TBqK7ma27RCP"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"-fpVbbY21CcA"},"outputs":[],"source":["#box plots to potentially visualize outliers\n","\n","fig, axes = plt.subplots(1, len(Numerical_features), figsize=(25, 8))\n","\n","# Loop through each feature and create a box plot\n","for i, feature in enumerate(Numerical_features):\n","    sns.boxplot(x='target', y=feature, data=df1, ax=axes[i])\n","    axes[i].set_title(f'{feature} by target')\n","    axes[i].set_xlabel('Target')\n","    axes[i].set_ylabel(feature)\n","\n","plt.tight_layout()\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UP5LaXqvNPJ4"},"outputs":[],"source":["#plot to visualize the average loan amount taken by the 2 categories of customers\n","\n","# Calculate mean total amount by target\n","mean_amount = df1.groupby('target')['Total_Amount'].mean()\n","\n","# Plot the mean total amount as a bar chart\n","plt.figure(figsize=(8, 6))\n","mean_amount.plot(kind='bar', color=['lightgreen', '#FFCCCC'], edgecolor='black')\n","\n","plt.title('Average Total Amount by Target', fontsize=14)\n","plt.xlabel('Target (0 = No Default, 1 = Default)', fontsize=12)\n","plt.ylabel('Average Total Amount', fontsize=12)\n","\n","# Annotate the bars with the median values\n","for i, val in enumerate(mean_amount):\n","    plt.text(i, val + 0.01 * val, f'{val:.2f}', ha='center', fontsize=10, fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"markdown","source":["The average loan amount for customers who default is actually higher than for those who manage to pay their loans back. Itâ€™s like the customers who found themselves in trouble had taken out bigger loans, only to realize later that they bit off more than they could chew.\n","\n","This insight is important because it shows us that bigger loans might carry bigger risks. When customers take out larger amounts, the chance of defaulting increases, perhaps because it becomes harder to manage a larger financial burden."],"metadata":{"id":"gncbNZBI9qe5"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"maKwPpm6tQCy"},"outputs":[],"source":["#Lets see the number of times each lender didn't receive their loans from customers\n","\n","# Calculate default rate for each lender\n","lender_default_rate = df1.groupby('lender_id')['target'].mean()\n","lender_default_rate = lender_default_rate.sort_values(ascending=False)\n","\n","# Create a colormap where the color fades as the default rate gets smaller\n","norm = plt.Normalize(lender_default_rate.min(), lender_default_rate.max())\n","cmap = plt.cm.Reds\n","\n","plt.figure(figsize=(12, 6))\n","bars = lender_default_rate.plot(kind='bar', color=cmap(norm(lender_default_rate.values)))\n","plt.title('Default Rate by Lender')\n","plt.xlabel('Lender ID')\n","plt.ylabel('Default Rate')\n","plt.xticks(rotation=45, ha='right')\n","plt.grid(axis='y', linestyle='--', alpha=0.7)\n","\n","# Add percentage annotations\n","for p in plt.gca().patches:\n","    height = p.get_height()\n","    percentage = f'{100 * height:.1f}%'\n","    plt.gca().annotate(percentage, (p.get_x() + p.get_width() / 2, height),\n","                       ha='center', va='bottom', fontsize=9, color='black', fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"markdown","source":["Lender 267278 attracts the highest number of customers compared to any other lender. Despite the large volume of customers, this lender maintains a very low default rate of just 1.2%. This suggests that, even with its popularity, its loan offerings and customer management are working well to ensure repayments.\n","\n","On the other hand, Lender 245684 receives a significantly lower number of customers. However, what stands out is the high default rate of 41.9% among its borrowers. This is a stark contrast to the much lower default rate of Lender 267278, even though the latter serves a larger customer base."],"metadata":{"id":"5jYWHdj_CRTx"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"WIm0sSeiIlSP"},"outputs":[],"source":["#let's see how many times each lender has been patronized\n","\n","fig, axes = plt.subplots(1, 1, figsize=(10, 6))\n","\n","column = 'lender_id'\n","title = 'Lender_id Count'\n","\n","# Get the counts for each lender_id\n","counts = df1[column].value_counts().sort_index()\n","\n","# Create a colormap where the highest value gets dark green and the others are lighter\n","norm = plt.Normalize(counts.min(), counts.max())\n","cmap = plt.cm.Greens\n","\n","sns.countplot(x=column, data=df1, ax=axes, palette=cmap(norm(counts.values)))\n","axes.set_title(title)\n","axes.set_xlabel(column)\n","axes.set_ylabel('Count')\n","\n","# Add annotations for the count above each bar\n","for i, val in enumerate(counts):\n","    axes.text(i, val + 0.01 * val, f'{val}', ha='center', fontsize=10, fontweight='bold')\n","\n","plt.tight_layout()\n","plt.show()\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RMmT4oiFR9jT"},"outputs":[],"source":["#Lets look at the relationship between amount loaned and the time it takes to repay the loan\n","plt.figure(figsize=(10,5))\n","\n","sns.scatterplot(x='Total_Amount', y='duration', data=df1, hue='target')\n","plt.title('Total Amount vs Duration')\n","plt.show()"]},{"cell_type":"markdown","source":["It appears that while customers who default and those who successfully repay their loans generally borrow within the same range of amounts, there is a noticeable difference in the loan durations. Specifically, customers who default tend to have longer loan durations compared to their counterparts who repay successfully.\n","\n","This suggests that longer loan durations might be a contributing factor to defaults, potentially indicating that extended repayment periods could be creating more opportunities for financial strain or making it harder for customers to keep up with their payments."],"metadata":{"id":"9kM_ByUNHvOU"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"hmCkKZS5VF7U"},"outputs":[],"source":["temporal_features = ['disbursement_date', 'due_date']\n","\n","#create date features year, month, day\n","df1['disbursement_year'] = df1['disbursement_date'].dt.year\n","df1['disbursement_month'] = df1['disbursement_date'].dt.month\n","df1['disbursement_day'] = df1['disbursement_date'].dt.day\n","\n","df2['disbursement_year'] = df2['disbursement_date'].dt.year\n","df2['disbursement_month'] = df2['disbursement_date'].dt.month\n","df2['disbursement_day'] = df2['disbursement_date'].dt.day\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F-jewB5hKxT9"},"outputs":[],"source":["# Function to plot trends for Total Amount loaned\n","def plot_trends(data, time_col, target_col, value_col, time_label):\n","    grouped = data.groupby([time_col, target_col])[value_col].mean().unstack()\n","    grouped.plot(kind='line', figsize=(12, 6), marker='o')\n","    plt.title(f'Trend of Total Loan Amount by {time_label}', fontsize=14)\n","    plt.xlabel(time_label, fontsize=12)\n","    plt.ylabel('Total Loan Amount', fontsize=12)\n","    plt.legend(['No Default (0)', 'Default (1)'], title='Target', fontsize=10)\n","    plt.grid(True, linestyle='--', alpha=0.7)\n","    plt.tight_layout()\n","    plt.show()\n","\n","# Plot yearly trends\n","plot_trends(df1, 'disbursement_year', 'target', 'Total_Amount', 'Year')\n","\n","# Plot monthly trends\n","plot_trends(df1, 'disbursement_month', 'target', 'Total_Amount', 'Month')\n","\n","# Plot daily trends\n","plot_trends(df1, 'disbursement_day', 'target', 'Total_Amount', 'Day')\n","\n"]},{"cell_type":"markdown","source":["It appears that the loan amounts of customers who defaulted tend to increase around February and December. This suggests that during these months, there might be a spike in the loan amounts taken by customers who ultimately struggle to repay.\n","\n","The correlation between higher loan amounts and specific months raises a few questions. It could be related to seasonal financial pressures, holiday spending, or other factors influencing borrowing behavior during these times. The increased loan amounts could be contributing to a higher risk of defaults, as customers may find it harder to repay larger loans."],"metadata":{"id":"gqahMroyMWwu"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"kChzRf5XjjB9"},"outputs":[],"source":["#Heatmap Correlation of Numeric features\n","Num_features = ['Total_Amount','disbursement_year','disbursement_month', 'Total_Amount_to_Repay', 'Amount_Funded_By_Lender',\n","       'Lender_portion_Funded', 'Lender_portion_to_be_repaid', 'lender_id', 'disbursement_day', 'target']\n","\n","plt.figure(figsize=(10,6))\n","sns.heatmap(df1[Num_features].corr(), annot=True, cbar=True, cmap=sns.diverging_palette(240,10))\n","plt.title('Correlation Heatmap of Numerical Features')\n","plt.show()"]},{"cell_type":"markdown","source":["Three features stand out as being slightly correlated with the likelihood of default:\n","\n","\n","\n","*  Lender Portion to be Repaid\n","*  Amount Funded by Lender\n","*  Disbursement Year\n","\n","While these correlations are not very strong, they do suggest that these features have some influence on the target variable."],"metadata":{"id":"CqG6zI7Tmrw_"}},{"cell_type":"markdown","metadata":{"id":"YE-2osEfXPa6"},"source":["# **Enriching the data with economic indicators**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VME6zkvhXOLe"},"outputs":[],"source":["# Define the list of critical indicators\n","critical_indicators = [\n","    \"Official exchange rate (LCU per US$, period average)\",\n","    \"Real interest rate (%)\",\n","    \"Lending interest rate (%)\",\n","    \"Average precipitation in depth (mm per year)\",\n","    \"Deposit interest rate (%)\",\n","    \"Inflation, consumer prices (annual %)\",\n","    \"Fossil fuel energy consumption (% of total)\",\n","    \"Interest rate spread (lending rate minus deposit rate, %)\",\n","    \"Unemployment rate\"\n","]\n","\n","# Filter the data for these indicators\n","df4_filtered = df4[df4['Indicator'].isin(critical_indicators)]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AQR-jvPGYdCm"},"outputs":[],"source":["#Reshape the filtered economic data\n","\n","df4_long = pd.melt(df4_filtered, id_vars=[\"Country\", \"Indicator\"], var_name=\"Year\", value_name=\"Value\")\n","\n","# Extract the year as an integer\n","df4_long['Year'] = df4_long['Year'].str.replace('YR', '').astype(int)\n","df4_long.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xbc3F6FxZfQP"},"outputs":[],"source":["# Lets Pivot the data to have indicators as columns\n","df4_pivoted = df4_long.pivot_table(\n","    index=[\"Country\", \"Year\"],\n","    columns=\"Indicator\",\n","    values=\"Value\"\n",").reset_index()\n","\n","# Remove the MultiIndex\n","df4_pivoted.columns.name = None"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fBWECNZPYq5i"},"outputs":[],"source":["# Merge the economic data with train and test datasets\n","df1_enriched = pd.merge(\n","    df1,\n","    df4_pivoted,\n","    how='left',\n","    left_on=['country_id', 'disbursement_year'],\n","    right_on=['Country', 'Year']\n",")\n","\n","df2_enriched = pd.merge(\n","    df2,\n","    df4_pivoted,\n","    how='left',\n","    left_on=['country_id', 'disbursement_year'],\n","    right_on=['Country', 'Year']\n",")\n","\n","# Drop unnecessary columns after the merge (optional)\n","df1_enriched.drop(columns=['Country', 'Year'], inplace=True)\n","df2_enriched.drop(columns=['Country', 'Year'], inplace=True)\n","display('df1_enriched', df1_enriched)\n","display('df2_enriched', df2_enriched)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lCnfHy4kbuW7"},"outputs":[],"source":["#Rename columns\n","\n","df1_enriched.rename(columns={'Official exchange rate (LCU per US$, period average)': 'Official_exchange_rate',\n","                             'Real interest rate (%)': 'Real_interest_rate', 'Average precipitation in depth (mm per year)': 'Average_precipitation',\n","                             'Deposit interest rate (%)': 'Deposit_interest_rate', 'Inflation, consumer prices (annual %)': 'Inflation',\n","                             'Fossil fuel energy consumption (% of total)': 'Fossil_fuel_energy_consumption',\n","                             'Interest rate spread (lending rate minus deposit rate, %)': 'Interest_rate_spread',\n","                             'Unemployment rate': 'Unemployment_rate', 'Lending interest rate (%)':'Lending interest rate'}, inplace=True)\n","\n","df2_enriched.rename(columns={'Official exchange rate (LCU per US$, period average)': 'Official_exchange_rate',\n","                             'Real interest rate (%)': 'Real_interest_rate', 'Average precipitation in depth (mm per year)': 'Average_precipitation',\n","                             'Deposit interest rate (%)': 'Deposit_interest_rate', 'Inflation, consumer prices (annual %)': 'Inflation',\n","                             'Fossil fuel energy consumption (% of total)': 'Fossil_fuel_energy_consumption',\n","                             'Interest rate spread (lending rate minus deposit rate, %)': 'Interest_rate_spread',\n","                             'Unemployment rate': 'Unemployment_rate', 'Lending interest rate (%)':'Lending interest rate'}, inplace=True)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"guHyFv6zduOq"},"outputs":[],"source":["#Average_precipitation, Fossil_fuel_energy_consumption are empty columns so we'll remove them\n","\n","df1_enriched = df1_enriched.drop(['Average_precipitation','Fossil_fuel_energy_consumption',\n","                                  'Real_interest_rate'], axis=1)\n","df2_enriched = df2_enriched.drop(['Average_precipitation','Fossil_fuel_energy_consumption',\n","                                  'Real_interest_rate'], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TuMFfIHlRuwP"},"outputs":[],"source":["#Fill missing values\n","\n","def fill_missing_values(df1_enriched, df2_enriched):\n","\n","    train_fill_values = {\n","        'Lending interest rate': 17.15,\n","        'Deposit_interest_rate': 11.85,\n","        'Inflation': 2.72,\n","        'Official_exchange_rate': 129.439,\n","        'Unemployment_rate': 5.7\n","    }\n","    df1_enriched.loc[df1_enriched['disbursement_year'] == 2024, train_fill_values.keys()] = df1_enriched.loc[df1_enriched['disbursement_year'] == 2024, train_fill_values.keys()].fillna(train_fill_values)\n","\n","    df1_enriched['Interest_rate_spread'] = df1_enriched['Lending interest rate'] - df1_enriched['Deposit_interest_rate']\n","\n","    # Fill missing values in the Test dataset for Ghana customers (2022-2024)\n","    ghana_conditions = df2_enriched['country_id'] == 'Ghana'\n","\n","    ghana_fill_values = {\n","        2021: {\n","            'Lending interest rate': 26.34,\n","\n","        },\n","        2022: {\n","            'Lending interest rate': 31.40,\n","\n","        },\n","        2023: {\n","            'Lending interest rate': 31.15,\n","\n","        },\n","        2024: {\n","            'Lending interest rate': 31.10,\n","            'Deposit_interest_rate': 11.00,\n","            'Inflation': 19.53,\n","            'Official_exchange_rate': 15.9834,\n","            'Unemployment_rate': 4.0\n","        }\n","    }\n","\n","    for year, values in ghana_fill_values.items():\n","        conditions = ghana_conditions & (df2_enriched['disbursement_year'] == year)\n","        df2_enriched.loc[conditions, values.keys()] = df2_enriched.loc[conditions, values.keys()].fillna(values)\n","\n","    # Fill missing values in the Test dataset for Kenya customers (2024 only)\n","    kenya_conditions = (df2_enriched['country_id'] == 'Kenya') & (df2_enriched['disbursement_year'] == 2024)\n","\n","    kenya_fill_values = {\n","        'Lending interest rate': 17.15,\n","        'Deposit_interest_rate': 11.85,\n","        'Inflation': 2.72,\n","        'Official_exchange_rate': 129.439,\n","        'Unemployment_rate': 5.7\n","    }\n","    df2_enriched.loc[kenya_conditions, kenya_fill_values.keys()] = df2_enriched.loc[kenya_conditions, kenya_fill_values.keys()].fillna(kenya_fill_values)\n","    df2_enriched['Interest_rate_spread'] = df2_enriched['Lending interest rate'] - df2_enriched['Deposit_interest_rate']\n","\n","    return df1_enriched, df2_enriched\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TV--nVRm3w_B"},"outputs":[],"source":["df1_enriched, df2_enriched = fill_missing_values(df1_enriched, df2_enriched)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"G0IopOHqW3Hu"},"outputs":[],"source":["#Mutual information to check for important features\n","from sklearn.feature_selection import mutual_info_classif\n","\n","mi_data = df1_enriched.copy()\n","\n","y_tg = mi_data['target']\n","X_ft = mi_data.drop(['target','ID','customer_id','tbl_loan_id','country_id','disbursement_date','due_date'], axis=1)\n","le = LabelEncoder()\n","X_ft['loan_type'] = le.fit_transform(X_ft['loan_type'])\n","X_ft['New_versus_Repeat'] = le.fit_transform(X_ft['New_versus_Repeat'])\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UCNEsnQnQVWp"},"outputs":[],"source":["# Calculate mutual information\n","mi_scores = mutual_info_classif(X_ft, y_tg, random_state=11)\n","mi_scores = pd.Series(mi_scores, index=X_ft.columns)\n","mi_scores = mi_scores.sort_values(ascending=False)\n","\n","print(mi_scores)"]},{"cell_type":"markdown","metadata":{"id":"Rja6cT0b6fNb"},"source":["# Data Preprocessing"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Nv0s_3GG_PfP"},"outputs":[],"source":["df1_enriched.shape, df2_enriched.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-Vz-hVic31y9"},"outputs":[],"source":["#Removing outliers didn't improve my model\n","\n","'''def remove_outliers_iqr(df, columns):\n","    for column in columns:\n","        Q1 = df[column].quantile(0.25)\n","        Q3 = df[column].quantile(0.75)\n","        IQR = Q3 - Q1\n","        lower_bound = Q1 - 1.5 * IQR\n","        upper_bound = Q3 + 1.5 * IQR\n","        df = df[(df[column] >= lower_bound) & (df[column] <= upper_bound)]\n","    return df\n","\n","df1_enriched = remove_outliers_iqr(df1_enriched, Numerical_features)'''\n"]},{"cell_type":"markdown","metadata":{"id":"Avvzt-WJBMvb"},"source":["# Features Engineering"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IeTgehMlBRIs"},"outputs":[],"source":["#Drop target\n","y = df1_enriched['target']\n","train_df = df1_enriched.drop(['target'], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rBLb1jUYZwqh"},"outputs":[],"source":["#Drop unnecessary columns\n","\n","train_df = train_df.drop(['ID','country_id','tbl_loan_id','disbursement_date', 'due_date', 'New_versus_Repeat'], axis=1)\n","test_df = df2_enriched.drop(['ID','country_id','tbl_loan_id','disbursement_date', 'due_date', 'New_versus_Repeat'], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_8ZsMSr8ZqBz"},"outputs":[],"source":["#Encoding categorical features\n","\n","combined_df = pd.concat([train_df, test_df], sort=False)\n","\n","\n","encoder = LabelEncoder()\n","combined_df['loan_type'] = encoder.fit_transform(combined_df['loan_type'])\n","combined_df['lender_id'] = encoder.fit_transform(combined_df['lender_id'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"smpulHSsaQ6k"},"outputs":[],"source":["#creating new features\n","\n","\n","combined_df['Loan_to_interest_rate'] = combined_df['Total_Amount'] * combined_df['Lending interest rate']\n","combined_df['Repayment_ratio'] = combined_df['Total_Amount_to_Repay'] / combined_df['Total_Amount']\n","combined_df['Interest_rate'] = (combined_df['Total_Amount_to_Repay'] - combined_df['Total_Amount']) / combined_df['Total_Amount']\n","# Replace negative values with zero in a feature\n","combined_df['Interest_rate'] = combined_df['Interest_rate'].apply(lambda x: max(x, 0))\n","combined_df['interest_rate_of_lender'] = (combined_df['Lender_portion_to_be_repaid'] - combined_df['Amount_Funded_By_Lender']) / combined_df['Amount_Funded_By_Lender']\n","# Replace negative values with zero in a feature\n","combined_df['interest_rate_of_lender'] = combined_df['interest_rate_of_lender'].apply(lambda x: max(x, 0))\n","\n","#=====================================================================================================================#\n","\n","combined_df['Amount_diff'] = combined_df['Total_Amount_to_Repay'] - combined_df['Total_Amount']\n","#Replace negative values with zero\n","combined_df['Amount_diff'] = combined_df['Amount_diff'].apply(lambda x: max(x, 0))\n","combined_df['Lender_diff'] = combined_df['Lender_portion_to_be_repaid'] - combined_df['Amount_Funded_By_Lender']\n","combined_df['Lender_diff'] = combined_df['Lender_diff'].apply(lambda x: max(x, 0))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lr9lJL7FcLmK"},"outputs":[],"source":["combined_df.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"adyLEg9uBpgM"},"outputs":[],"source":["#fill rows where the lender has no interest with zero\n","\n","combined_df['interest_rate_of_lender'].fillna(0,inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RtIS-V3cGvIj"},"outputs":[],"source":["#log transform to address skewness\n","\n","combined_df['Total_Amount'] = np.log1p(combined_df['Total_Amount'])\n","combined_df['Lender_portion_Funded'] = np.log1p(combined_df['Lender_portion_Funded'])\n","combined_df['Repayment_ratio'] = np.log1p(combined_df['Repayment_ratio'])\n","combined_df['Interest_rate'] = np.log1p(combined_df['Interest_rate'])\n","combined_df['interest_rate_of_lender'] = np.log1p(combined_df['interest_rate_of_lender'])\n","combined_df['Loan_to_interest_rate'] = np.log1p(combined_df['Loan_to_interest_rate'])\n","combined_df['Amount_diff'] = np.log1p(combined_df['Amount_diff'])\n","combined_df['Lender_diff'] = np.log1p(combined_df['Lender_diff'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"knBhyhXKTNT0"},"outputs":[],"source":["#create a cluster list and use unsupervised learning to potentially discover some patterns\n","\n","cluster_list = ['lender_id','duration','loan_type','disbursement_year',\n","                 'Interest_rate', 'interest_rate_of_lender']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mdC5RFGwNRK0"},"outputs":[],"source":["from sklearn.cluster import KMeans\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.metrics import silhouette_score\n","\n","comb_cluster = combined_df[cluster_list]\n","scaler = StandardScaler()\n","comb_cluster_scaled = scaler.fit_transform(comb_cluster)\n","\n","wcss = []\n","silhoutte_scores = []\n","\n","for k in range(2,11):\n","  kmeans = KMeans(n_clusters=k, init='k-means++', random_state=67)\n","  kmeans.fit(comb_cluster_scaled)\n","  wcss.append(kmeans.inertia_)\n","  silhoutte_scores.append(silhouette_score(comb_cluster_scaled, kmeans.labels_))\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Y2s4Tr1S-A9w"},"outputs":[],"source":["plt.figure(figsize=(8,5))\n","plt.plot(range(2,11), wcss, marker='o', linestyle='--')\n","plt.title('The Elbow Method')\n","plt.xlabel('Number of clusters K')\n","plt.ylabel('WCSS')\n","plt.show()\n","\n","plt.figure(figsize=(8,5))\n","plt.plot(range(2,11), silhoutte_scores, marker='o', linestyle='--', color='orange', label='Silhoutte Score')\n","plt.title('Silhouette Score')\n","plt.xlabel('Number of clusters K')\n","plt.ylabel('Silhouette Score')\n","plt.show()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mpL3syX2IkX-"},"outputs":[],"source":["#split original data back to train and test\n","\n","Train = combined_df.iloc[:len(y), :]\n","Test = combined_df.iloc[len(y):, :]\n","print('Train Shape: ',Train.shape, end='\\n\\n')\n","print('Test Shape: ',Test.shape, end='\\n\\n')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"pZEfhiziD-sA"},"outputs":[],"source":["optimal_k = 7\n","kmeans = KMeans(n_clusters=optimal_k, init='k-means++', random_state=17)#17\n","comb_cluster['cluster'] = kmeans.fit_predict(comb_cluster_scaled)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mCGuE9vvFBBA"},"outputs":[],"source":["Train_with_clust = comb_cluster.iloc[:len(y), :]\n","Test_with_clust = comb_cluster.iloc[len(y):, :]\n","print('Train with clust Shape: ',Train_with_clust.shape, end='\\n\\n')\n","print('Test with clust Shape: ',Test_with_clust.shape, end='\\n\\n')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tAKVrnNdFsgU"},"outputs":[],"source":["Train['cluster'] = Train_with_clust['cluster']\n","Test['cluster'] = Test_with_clust['cluster']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TL_1WsCCI846"},"outputs":[],"source":["Train.shape, Test.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Sos5-_iGaW6t"},"outputs":[],"source":["#Drop unimportant and one of highly correlated features\n","\n","Train = Train.drop(['Unemployment_rate','Interest_rate_spread','Inflation','Deposit_interest_rate','Official_exchange_rate',\n","                    'Total_Amount_to_Repay','Amount_Funded_By_Lender','Lending interest rate'], axis=1)\n","Test = Test.drop(['Unemployment_rate','Interest_rate_spread','Inflation','Deposit_interest_rate','Official_exchange_rate',\n","                  'Total_Amount_to_Repay','Amount_Funded_By_Lender','Lending interest rate'], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"q943bT67os11"},"outputs":[],"source":["Train.shape, Test.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"d0ceh7CIWPVi"},"outputs":[],"source":["#Addressing class imbalance with SMOTENN\n","#from imblearn.combine import SMOTEENN\n","#smote_enn = SMOTEENN(random_state=20) #25\n","#train_resampled, y_resampled = smote_enn.fit_resample(Train, y) #Didn't perform well as class weights"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SiskaoCMe5iO"},"outputs":[],"source":["#y_resampled.value_counts()"]},{"cell_type":"markdown","metadata":{"id":"-Vqho-fWi9V0"},"source":["# **Model Training**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DyG_E049eBl4"},"outputs":[],"source":["#y = y\n","class_weights = calculate_class_weights(y)\n","print(class_weights)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gWXZitNveBwx"},"outputs":[],"source":["#Splitting the training data into train and validation sets\n","#X_train, X_val, y_train, y_val = train_test_split(train_resampled, y_resampled, test_size=0.2, random_state=11, stratify=y_resampled)\n","X_train, X_val, y_train, y_val = train_test_split(Train, y, test_size=0.2, random_state=11, stratify=y)\n","#random_state=11"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EkSbULW4lPmN"},"outputs":[],"source":["X_train.shape, X_val.shape, y_train.shape, y_val.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cyhI5u4i5IOf"},"outputs":[],"source":["#Define group labels for stratified groupkfold cross validation\n","group_labels = X_train['customer_id']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"W9vbvQxW8Wlj"},"outputs":[],"source":["# Drop customer_id after creating group labels\n","X_train = X_train.drop(columns=['customer_id'])\n","X_val = X_val.drop(columns=['customer_id'])\n","Test = Test.drop(columns=['customer_id'])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vvHBCsMc8f-f"},"outputs":[],"source":["X_train.shape, X_val.shape, y_train.shape, y_val.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gLhSFIAMVce9"},"outputs":[],"source":["class_names = ['Class 0', 'Class 1']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tcSkITQm-AhU"},"outputs":[],"source":["#xgboost stratified group kfold cross validation\n","\n","xgboost_model = xgb.XGBClassifier(n_estimators=900,max_depth=12,learning_rate=0.007,\n","                                       alpha=0.7,subsample=0.6682761162470723,\n","                                        class_weights=class_weights,random_state=20)\n","mean_f1_xgboost = stratified_groupkfold_cv(xgboost_model, X_train, y_train, groups=group_labels, n_splits=10,\n","                                           class_weights=class_weights, verbose=True)\n","# Print the mean F1-score across folds\n","print(f\"Mean F1-Score across folds (XgBoost): {mean_f1_xgboost:.4f}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tvu3hiSH-CJQ"},"outputs":[],"source":["#Fit and make predictions on validation data\n","xgboost_model.fit(X_train, y_train)\n","xgboost_val_pred = xgboost_model.predict(X_val)\n","print(classification_report(y_val, xgboost_val_pred))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KDsFGy4J-CqM"},"outputs":[],"source":["#calculate metric scores\n","\n","xgb_score = f1_score(y_val, xgboost_val_pred)\n","xgb_auc_score = roc_auc_score(y_val, xgboost_val_pred)\n","xgb_acc_score = accuracy_score(y_val, xgboost_val_pred)\n","xgb_prec_score = precision_score(y_val, xgboost_val_pred)\n","xgb_recall_score = recall_score(y_val, xgboost_val_pred)\n","print(f\"F1 Score: {xgb_score}\")\n","print(f\"AUC Score: {xgb_auc_score}\")\n","print(f\"Accuracy Score: {xgb_acc_score}\")\n","print(f\"Precision Score: {xgb_prec_score}\")\n","print(f\"Recall Score: {xgb_recall_score}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"meashc5D_J2i"},"outputs":[],"source":["#Visualize confusion matrix\n","\n","plot_confusion_matrix(y_val, xgboost_val_pred, class_names)"]},{"cell_type":"code","source":["# plot ROC curve\n","y_prob = xgboost_model.predict_proba(X_val)[:, 1]\n","fpr, tpr, thresholds = roc_curve(y_val, y_prob)\n","roc_auc = auc(fpr, tpr)\n","\n","\n","plt.figure(figsize=(8,6))\n","plt.plot(fpr, tpr, color='blue', lw=2, label=f'AUC = {roc_auc:.2f}')\n","plt.plot([0, 1], [0, 1], color='red', lw=2, linestyle='--')\n","plt.xlim([0.0, 1.0])\n","plt.ylim([0.0, 1.05])\n","plt.xlabel('False Positive Rate')\n","plt.ylabel('True Positive Rate')\n","plt.title('Receiver Operating Characteristic (ROC) Curve')\n","plt.show()"],"metadata":{"id":"hgAvzKUcYzau"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"warBClE0_KfG"},"outputs":[],"source":["#make predictions\n","xgboost_pred = xgboost_model.predict(Test)\n","xgboost_sub = df3[['ID']]\n","xgboost_sub['target'] = xgboost_pred\n","xgboost_sub.to_csv('xgboost_sub_african.csv', index=False)"]},{"cell_type":"code","source":["xgboost_sub['target'].value_counts()"],"metadata":{"id":"jqGtwfB-8DCi"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#A Little magic trick i learnt from one of the participants in the challenge @VincentSchuler\n","# which involves post processing the predictions. Honestly i don't know how he came about the conclusion or\n","# what he noticed in the data to come up with this idea.\n","# Essentially what he did here was to set the target to 1 if the following 2 conditions are met:\n","# 1. if the loan_type is loan_type_3\n","# 2. The last loan taken by each customer\n","\n","data2['target'] = xgboost_pred\n","\n","# Identify the last loan for each customer based on loan_id\n","data2['is_last_loan'] = data2.groupby('customer_id')['tbl_loan_id'].transform('max') == data2['tbl_loan_id']\n","\n","# The conditions\n","condition_1 = (data2['loan_type'] == 'Type_3')\n","condition_2 = data2['is_last_loan']\n","\n","# Update the target column based on the conditions\n","data2.loc[condition_1 & condition_2, 'target'] = 1\n","data2.drop(columns=['is_last_loan'], inplace=True)"],"metadata":{"id":"pAg9rkhThlR7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["updated_sub = data2[['ID', 'target']]\n","updated_sub.to_csv('updated_sub.csv', index=False)"],"metadata":{"id":"xrQpO-Ju7ovG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["updated_sub['target'].value_counts()"],"metadata":{"id":"6-NgpFFi8R4D"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["***And it worked!***\n","\n","\n","![Screenshot (91).png](data:image/png;base64,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)"],"metadata":{"id":"2OAMo34ggTbY"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"X3KVJ4HK_K6e"},"outputs":[],"source":["visualize_feature_importance(xgboost_model, X_train.columns)"]},{"cell_type":"markdown","source":["The model considers the repayment ratio, interest rate, and interest rate of lender as the top 3 important features.\n","\n","Let's look at Shap"],"metadata":{"id":"o1EzDwzsprHM"}},{"cell_type":"markdown","metadata":{"id":"CcjOYW1485t1"},"source":["**Feature Importance with Shap**"]},{"cell_type":"markdown","metadata":{"id":"E3BLwDO4-w2P"},"source":["Bar plot"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CvaZ7Pvf9CVD"},"outputs":[],"source":["import shap"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Rj03Gzvc-14Q"},"outputs":[],"source":["explainer = shap.Explainer(xgboost_model, X_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cs-wC3NUgvNq"},"outputs":[],"source":["# Compute SHAP values for test set\n","shap_values = explainer(X_val)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5TFb7emuxszN"},"outputs":[],"source":["shap.plots.beeswarm(shap_values, order=shap_values.abs.max(0), max_display=30)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lvmOG0dyzAt7"},"outputs":[],"source":["shap.plots.bar(shap_values.abs.mean(0), max_display=30)"]},{"cell_type":"markdown","source":["With shap feature importance, Amount diff (The difference between Total Amount loaned and Total Amount to repay) as the most important feature"],"metadata":{"id":"5nCO_mgxqCxL"}},{"cell_type":"markdown","metadata":{"id":"xy_ogEA2E1GX"},"source":["Hyper-Parameter Tuning with Optuna"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Gdyb2S2dYBww"},"outputs":[],"source":["# Suggest hyperparameters\n","def objective(trial):\n","  param = {\n","        \"n_estimators\": trial.suggest_int(\"n_estimators\", 100, 1000),\n","        \"max_depth\": trial.suggest_int(\"max_depth\", 10, 15),\n","        \"learning_rate\": trial.suggest_float(\"learning_rate\", 0.009, 0.1, log=True),\n","        \"alpha\": trial.suggest_float(\"alpha\", 0, 10.0),\n","        \"subsample\": trial.suggest_float(\"subsample\", 0.0, 1.0),\n","        \"random_state\": 11,\n","    }\n","\n","  model_xgb = xgb.XGBClassifier(**param, class_weight=class_weights, eval_metric='logloss')\n","  mean_f1 = stratified_groupkfold_cv(model_xgb, X_train, y_train, groups=group_labels, n_splits=10,\n","                                       class_weights=class_weights, verbose=False)\n","\n","  return mean_f1\n","\n","# Create study and optimize\n","study = optuna.create_study(direction=\"maximize\")\n","study.optimize(objective, n_trials=50)\n","\n","# Print best parameters\n","print(\"Best Hyperparameters:\", study.best_params)\n","print(\"Best F1 Score:\", study.best_value)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CcBxTf_nKOLg"},"outputs":[],"source":["#xgboost\n","xgboost_tuned_model = xgb.XGBClassifier(n_estimators=607,max_depth=12,learning_rate=0.0691235636262062,\n","                                        alpha=5.544588290622663,subsample=0.5730203503666051,\n","                                        class_weights=class_weights,random_state=11)\n","mean_f1 = stratified_groupkfold_cv(xgboost_tuned_model, X_train, y_train, groups=group_labels, n_splits=10,\n","                                           class_weights=class_weights, verbose=True)\n","# Print the mean F1-score across folds\n","print(f\"Mean F1-Score across folds (XgBoost): {mean_f1:.4f}\")\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ScxRcuL8ApQy"},"outputs":[],"source":["tuned_xgboost_val_pred = xgboost_tuned_model.predict(X_val)\n","print(classification_report(y_val, tuned_xgboost_val_pred))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"s4gQpuqMA0rK"},"outputs":[],"source":["xgb_score = f1_score(y_val, tuned_xgboost_val_pred)\n","print(f\"F1 Score: {xgb_score}\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_67BywnIAixK"},"outputs":[],"source":["xgboost_pred = xgboost_tuned_model.predict(Test)\n","xgboost_sub = df3[['ID']]\n","xgboost_sub['target'] = xgboost_pred\n","xgboost_sub.to_csv('xgboost_sub_african34.csv', index=False)\n"]}],"metadata":{"colab":{"provenance":[{"file_id":"1xCB_rL7RHXb8SmCJeb0EVgIY_pDVM3Bv","timestamp":1735057663797},{"file_id":"1Usd_xe9n1LVQ9J_W_9oWl9KkrCbSeBAz","timestamp":1733963445098},{"file_id":"1TXxI-0ozSeuO41TXJqqCqTgOxZpjZ94X","timestamp":1733908608403},{"file_id":"1YQY7W19ehxnmdJ35BCPPZe2xliKamVEK","timestamp":1733750536112},{"file_id":"10v7I4Xd_yYOLUrEeQJzrM7RXx-OKjoNv","timestamp":1733692528564}],"mount_file_id":"10v7I4Xd_yYOLUrEeQJzrM7RXx-OKjoNv","authorship_tag":"ABX9TyPAkxu2Yhri+hzkQQkyBJs7"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}